<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>MASTER ADMIN v3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
    <style>
        body { font-family: sans-serif; background: #f4f4f4; padding: 40px; }
        .tab-content { display: none; } .tab-content.active { display: block; }
        input, textarea, select { width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ccc; border-radius: 8px; }
        button { background: #000; color: #fff; padding: 12px 24px; border-radius: 8px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>
    <div class="max-w-6xl mx-auto bg-white p-10 rounded-3xl shadow-xl">
        <header class="flex justify-between mb-10 border-b pb-5">
            <h1 class="text-2xl font-black italic">STUDIO ADMIN</h1>
            <nav class="flex gap-4">
                <button onclick="openTab('inventory')">Ürünler</button>
                <button onclick="openTab('ui')">Slayder</button>
                <button onclick="openTab('settings')">Ayarlar</button>
            </nav>
        </header>

        <div id="inventory" class="tab-content active grid lg:grid-cols-2 gap-10">
            <div>
                <h2 class="font-bold mb-4">Yeni Ürün Ekle</h2>
                <input id="pId" type="hidden">
                <input id="pTitle" placeholder="Başlık">
                <input id="pPrice" placeholder="Fiyat">
                <select id="pCatList"></select>
                <input id="pSlug" placeholder="Gumroad Slug">
                <input id="pImg" placeholder="Resim URL">
                <textarea id="pDesc" placeholder="Açıklama"></textarea>
                <button onclick="saveProduct()">Kaydet</button>
            </div>
            <div>
                <h2 class="font-bold mb-4">Kategoriler</h2>
                <div class="flex gap-2 mb-4"><input id="newCat" placeholder="Kategori Adı" class="!mb-0"><button onclick="addCat()">+</button></div>
                <div id="cat-list" class="flex flex-wrap gap-2 mb-10"></div>
                <h2 class="font-bold mb-4">Ürün Listesi</h2>
                <div id="inventory-list" class="space-y-2"></div>
            </div>
        </div>

        <div id="ui" class="tab-content">
            <h2 class="font-bold mb-4">Slayder Yönetimi</h2>
            <input id="slideImg" placeholder="Slayt Resim URL">
            <input id="slideLink" placeholder="Gumroad Slug">
            <input id="slideMeta" placeholder="Slayt Alt Metni (Açıklama)">
            <button onclick="addSlide()">Slayt Ekle</button>
            <div id="slider-list" class="grid grid-cols-3 gap-4 mt-10"></div>
        </div>

        <div id="settings" class="tab-content">
            <h2 class="font-bold mb-4">Site Ayarları</h2>
            <input id="setLogo" placeholder="Logo Ana">
            <input id="setLogoAccent" placeholder="Logo Vurgu">
            <textarea id="setFooterDesc" placeholder="Footer Yazısı"></textarea>
            <input id="setInsta" placeholder="Instagram Link">
            <button onclick="saveSettings()">Güncelle</button>
        </div>
    </div>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDs6JHPSV8UM2uKSSVUA1SNxWGyxAihaII",
            authDomain: "mockup-master-db.firebaseapp.com",
            databaseURL: "https://mockup-master-db-default-rtdb.firebaseio.com",
            projectId: "mockup-master-db",
            storageBucket: "mockup-master-db.firebasestorage.app",
            messagingSenderId: "68063883147",
            appId: "1:68063883147:web:07debadc7efe4aeccac98e"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function openTab(id) { document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active')); document.getElementById(id).classList.add('active'); }

        // ÜRÜN İŞLEMLERİ
        function saveProduct() {
            const id = document.getElementById('pId').value || Date.now();
            db.ref('products/' + id).set({
                id, title: document.getElementById('pTitle').value, price: document.getElementById('pPrice').value,
                cat: document.getElementById('pCatList').value, slug: document.getElementById('pSlug').value,
                img: document.getElementById('pImg').value, desc: document.getElementById('pDesc').value
            }, () => { alert("Kaydedildi"); location.reload(); });
        }

        db.ref('products').on('value', snap => {
            const prods = snap.val() ? Object.values(snap.val()) : [];
            document.getElementById('inventory-list').innerHTML = prods.map(p => `<div class="p-2 bg-gray-100 flex justify-between"><span>${p.title}</span> <button onclick="db.ref('products/${p.id}').remove()">SİL</button></div>`).join('');
        });

        // KATEGORİ İŞLEMLERİ
        function addCat() {
            const val = document.getElementById('newCat').value;
            if(val) db.ref('categories').push(val, () => { document.getElementById('newCat').value = ""; });
        }

        db.ref('categories').on('value', snap => {
            const cats = snap.val() ? Object.entries(snap.val()) : [];
            document.getElementById('cat-list').innerHTML = cats.map(([id, n]) => `<span class="bg-black text-white px-3 py-1 rounded-full text-xs">${n} <i onclick="db.ref('categories/${id}').remove()" class="cursor-pointer ml-2">x</i></span>`).join('');
            document.getElementById('pCatList').innerHTML = cats.map(([id, n]) => `<option value="${n}">${n}</option>`).join('');
        });

        // SLAYDER İŞLEMLERİ
        function addSlide() {
            db.ref('hero_slider').push({ 
                img: document.getElementById('slideImg').value, 
                link: document.getElementById('slideLink').value,
                meta: document.getElementById('slideMeta').value 
            });
        }

        db.ref('hero_slider').on('value', snap => {
            const slides = snap.val() ? Object.entries(snap.val()) : [];
            document.getElementById('slider-list').innerHTML = slides.map(([id, s]) => `<div class="relative"><img src="${s.img}" class="h-20 w-full object-cover rounded"><button class="absolute top-0 right-0 bg-red-500 text-white p-1" onclick="db.ref('hero_slider/${id}').remove()">X</button></div>`).join('');
        });

        // AYARLAR
        function saveSettings() {
            db.ref('settings').set({
                logo: document.getElementById('setLogo').value,
                logoAccent: document.getElementById('setLogoAccent').value,
                footerDesc: document.getElementById('setFooterDesc').value,
                insta: document.getElementById('setInsta').value
            }, () => alert("Ayarlar Güncellendi"));
        }

        db.ref('settings').on('value', snap => {
            const s = snap.val() || {};
            document.getElementById('setLogo').value = s.logo || "";
            document.getElementById('setLogoAccent').value = s.logoAccent || "";
            document.getElementById('setFooterDesc').value = s.footerDesc || "";
            document.getElementById('setInsta').value = s.insta || "";
        });
    </script>
</body>
</html>
